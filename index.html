<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Welcome</title>
  </head>

  <body>
    <h1>
      Welcome World. Your tasting palate is about to be blown away.<br /><br />
      v1 - default welcome page<br />
      v2 - displaying my tasting<br />
      v3 - Correcting syntax<br />
      v4 - domain resolution<br />
      v5 - correcting HTML syntax<br />
      v6 - adding debugging code
    </h1>

    <pre id="out">Loading…</pre>

<script type="module">
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

  const SUPABASE_URL = "https://uzgwhofpmdgvyottchzx.supabase.co";
  const SUPABASE_ANON_KEY =
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV6Z3dob2ZwbWRndnlvdHRjaHp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg0MjUwODQsImV4cCI6MjA4NDAwMTA4NH0.pJkYm8EftixLt496JEvOoSHC0Ph31kYp5NVXctG41o4";

  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  async function loadLeaderboard() {
    const out = document.getElementById("out");
    out.textContent = "Script running… contacting Supabase…";

    try {
      const { data, error } = await supabase
        .from("tasting_leaderboard")
        .select("*")
        .limit(500);

      if (error) {
        out.textContent = "Supabase error:\n" + JSON.stringify(error, null, 2);
        return;
      }

      out.textContent =
        "Query succeeded. Rows returned: " + (data?.length ?? "null") + "\n\n" +
        JSON.stringify(data, null, 2);

    } catch (e) {
      out.textContent = "JS exception:\n" + (e?.stack || e?.message || String(e));
    }
  }

  loadLeaderboard();
</script>
  </body>
</html>
